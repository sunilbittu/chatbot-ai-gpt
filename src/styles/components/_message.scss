.message {
  @include flex(column);
  gap: map-get($spacing, xs);
  
  &--user {
    align-items: flex-end;
    
    .message__content {
      @include gradient(to right, map-get($color-primary, main), map-get($color-secondary, main));
      color: white;
    }
  }
  
  &--bot {
    align-items: flex-start;
    
    .message__content {
      background-color: white;
      border: 1px solid map-get($color-gray, 100);
    }
  }
  
  &__content {
    @include message-bubble;
    max-width: 240px;
    padding: map-get($spacing, sm);
    
    p {
      white-space: pre-wrap;
      font-size: map-get($font-size, sm);
    }
  }
  
  &__image {
    max-width: 240px;
    max-height: 180px;
    object-fit: contain;
    border-radius: map-get($border-radius, lg);
    cursor: pointer;
    
    &:hover {
      opacity: 0.95;
    }
  }
  
  &__actions {
    @include flex(row);
    gap: map-get($spacing, xs);
    margin-top: map-get($spacing, sm);
  }
  
  &__action-button {
    @include flex(row, center, center);
    width: 24px;
    height: 24px;
    border-radius: map-get($border-radius, md);
    background-color: map-get($color-gray, 50);
    color: map-get($color-gray, 500);
    
    &:hover {
      background-color: map-get($color-gray, 100);
    }
    
    &:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    &--primary {
      background-color: map-get($color-primary, light);
      color: map-get($color-primary, dark);
      
      &:hover {
        background-color: lighten(map-get($color-primary, light), 5%);
      }
    }
  }
  
  &__meta {
    @include flex(row, flex-start, center);
    gap: map-get($spacing, xs);
  }
  
  &__timestamp {
    font-size: map-get($font-size, xs);
    color: map-get($color-gray, 500);
  }
  
  &__status {
    @include flex(row, center, center);
    color: map-get($color-gray, 400);
    
    &-dot {
      width: 3px;
      height: 3px;
      background-color: currentColor;
      border-radius: map-get($border-radius, full);
      animation: pulse 1.5s infinite;
    }
    
    &--read {
      color: map-get($color-primary, main);
    }
  }
  
  &__action-icon {
    &--spin {
      animation: spin 1s linear infinite;
    }
  }
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}